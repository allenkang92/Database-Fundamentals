# 응용 SQL

1. 다중 행 연산자

## 다중 행 연산자 개념

다중 행 연산자는 서브 쿼리의 결과가 여러 개의 튜플을 반환하는 다중 행 서브쿼리에서 사용되는 연산자

## 다중 행 연산자 종류

다중 행 연산자로 IN, ANY, SOME, ALL, EXISTS를 사용

다중 행 비교 연산자는 단일 행 비교 연산자(<, >, =, <>)와 결합하여 사용 가능

다중 행 연산자 종류

IN

리턴되는 값 중에서 조건에 해당하는 값이 있으면 참

ANY, SOME

서브쿼리에 의해 리턴되는 각각의 값과 조건을 비교하여 하나 이상을 만족하면 참

ALL

값을 서브쿼리에 의해 리턴되는 모든 값과 조건 값을 비교하여 모든 값을 만족해야만 참

EXISTS 

메인 쿼리의 비교 조건이 서브쿼리의 결과 중에서 만족하는 값이 하나라도 존재하면 참

2. 집계 함수 

## 집계 함수

집계 함수(Aggregate Function)의 개념

집계 함수는 여러 행 도는 테이블 전체 행으로부터 하나의 결과값을 반환하는 함수

### 집계 함수 구문

SELECT 컬럼1, 컬럼2, …, 집계함수

   FROM 테이블명

[WHERE 조건]

GROUP BY 컬럼1, 컬럼2, …

[HAVING 조건식(집계함수 포함)]

WHERE 조건으로 지정된 데이터 집합으로부터 그룹화된 집합에 대한 조건 선택 시에 HAVING을 사용하는 것이다.

GROUP BY 구문 뒤에는 테이블을 구분하는 컬럼을 기재하여 그룹화한ㄷ,

HAVING 구문은 그룹화된 집합에 대한 조건 지정 시 사용하고, 상수나 집약 함수, 집약 키를 사용할 수 있다.

3. GROUP BY 및 HAVING 구문

## GROUP BY 구문

SQL에서는 WHERE 구문을 활용하여 조건별 대상 ROW를 선택한다.

복수 ROW 대상의 데이터 분석 시 그룹핑 대상이 되는 부분을 선별할 필요가 있다.

GROUP BY는 그와 같은 경우에 사용하며, 

NULL값을 가지는 ROW는 제외한 후 산출한다.

SELECT에서 사용하는 것과 같은 ALIAS 사용이 불가하다

WHERE 구문 안에 포함되지 않는다

WHERE 구문은 GROUP BY보다 먼저 실행되고, 대상이 되는 단일 행을 사전에 선별하는 역할을 한다.

GROUP BY 구문은 실제 구체적 데이터 분석값을 보고자 하는 컬럼 단위를 선정할 때 사용되는 기준이 되며, 이 부분의 조정을 통해 사용자가 원하는 분석 데이터를 볼 수 있게 해 준다.

## HAVING 구문

HAVING 구문은 WHERE 구문 내에는 사용할 수 없는 집계 함수의 구문을 적용하여 복수 행의 계산 결과를 조건별로 적용하는 데 사용된다.

일반적으로 GROUP BY 뒤에 기재하며, GROUP BY 구문의 기준 항목이나 소그룹 집계 함수를 활용한 조건을 적용하는 데 사용한다.

4. 집계 함수의 종류

## 집계 함수의 종류

집계 특성상 숫자 유형의 계산에 사용되는 것이 대다수이나, MAX/MIN 또는 COUNT와 같이 문자열 유형의 최대/최소나 건수 계산 등에도 사용한다.

집계 함수 종류

COUNT 

복수 행의 줄 수를 반환하는 함수

SUM

복수 행의 해당 컬럼 간의 합계를 계산하는 함수

AVG

복수 행의 해당 컬럼 간의 평균을 계산하는 함수

MAX

복수 행의 해당 컬럼 중 최댓값을 계산하는 함수

MIN

복수 행의 해당 컬럼 중 최솟값을 계산하는 함수

STDDEV

복수 행의 해당 컬럼 간의 표준편차를 계산하는 함수

VARANCE

복수 행의 해당 컬럼 간의 분산을 계산하는 함수