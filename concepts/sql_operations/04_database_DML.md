# 데이터 조작어 (Data Manipulation Language, DML)

## 1. DML의 개념
- 데이터베이스에 저장된 데이터를 조작(입력, 수정, 삭제, 조회)하는 언어
- 데이터베이스의 기본 연산인 CRUD(Create, Read, Update, Delete) 수행
- 사용자와 DBMS 간의 인터페이스 제공
- 데이터의 검색/삽입/삭제/변경에 사용

## 2. DML 기본 명령어

### 2.1 SELECT (조회)
데이터베이스에서 데이터를 검색하는 기본 명령어입니다.

#### 2.1.1 주요 절
- DISTINCT: 중복된 행을 제거하고 유일한 값만 조회
- WHERE: 조건에 맞는 행만 선택
- GROUP BY: 특정 열을 기준으로 그룹화
- HAVING: 그룹화된 결과에 조건 적용
- ORDER BY: 결과를 특정 열 기준으로 정렬

#### 2.1.2 기본 문법
```sql
SELECT [DISTINCT] 컬럼명 [,컬럼명...]
FROM 테이블명
[WHERE 조건식]
[GROUP BY 컬럼명]
[HAVING 조건식]
[ORDER BY 컬럼명 [ASC|DESC]];
```

#### 2.1.3 예시
```sql
-- 모든 학생 정보 조회
SELECT * FROM 학생;

-- 3학년 학생의 이름과 학과만 조회
SELECT 이름, 학과 FROM 학생 WHERE 학년 = 3;
```

### 2.2 INSERT (삽입)
테이블에 새로운 행을 추가하는 명령어입니다.

#### 2.2.1 특징
- 컬럼명 미지정 시 모든 컬럼값 순서대로 입력 필요
- 컬럼명 지정 시 필요한 컬럼만 값 입력 가능
- NULL이 허용된 컬럼은 생략 가능

#### 2.2.2 기본 문법
```sql
INSERT INTO 테이블명 [(컬럼명1, 컬럼명2, ...)]
VALUES (값1, 값2, ...);
```

#### 2.2.3 예시
```sql
-- 학번, 이름, 학년만 지정하여 입력
INSERT INTO 학생 (학번, 이름, 학년) 
VALUES ('20230001', '김철수', 1);
```

### 2.3 UPDATE (수정)
테이블의 기존 데이터를 수정하는 명령어입니다.

#### 2.3.1 특징
- WHERE 절로 수정할 행을 지정
- WHERE 절 없으면 모든 행이 수정됨 (주의 필요)
- 여러 컬럼 동시 수정 가능

#### 2.3.2 기본 문법
```sql
UPDATE 테이블명
SET 컬럼명1 = 값1 [, 컬럼명2 = 값2, ...]
[WHERE 조건식];
```

#### 2.3.3 예시
```sql
-- 특정 학번의 학생 학년을 2학년으로 변경
UPDATE 학생 
SET 학년 = 2 
WHERE 학번 = '20230001';
```

### 2.4 DELETE (삭제)
테이블에서 행을 삭제하는 명령어입니다.

#### 2.4.1 특징
- WHERE 절로 삭제할 행을 지정
- WHERE 절 없으면 모든 행이 삭제됨 (주의 필요)
- 삭제된 데이터는 복구가 어려움

#### 2.4.2 기본 문법
```sql
DELETE FROM 테이블명
[WHERE 조건식];
```

#### 2.4.3 예시
```sql
-- 특정 학번의 학생 정보 삭제
DELETE FROM 학생 WHERE 학번 = '20230001';
```

## 3. SELECT 문의 주요 절

### 3.1 WHERE 절
조회할 데이터의 조건을 지정하는 절입니다.

#### 3.1.1 연산자
- 비교 연산자: =, >, <, >=, <=, <>
- 논리 연산자: AND, OR, NOT
- BETWEEN: 범위 조건
- IN: 목록 중 일치하는 조건
- LIKE: 패턴 매칭

#### 3.1.2 예시
```sql
-- 비교 연산자
SELECT * FROM 학생 WHERE 학년 >= 3;

-- 논리 연산자
SELECT * FROM 학생 
WHERE 학년 >= 3 AND 학과 = '컴퓨터공학';

-- BETWEEN
SELECT * FROM 학생 
WHERE 학년 BETWEEN 2 AND 3;

-- IN
SELECT * FROM 학생 
WHERE 학과 IN ('컴퓨터공학', '전자공학');

-- LIKE
SELECT * FROM 학생 WHERE 이름 LIKE '김%';
```

### 3.2 GROUP BY 절
데이터를 그룹화하여 집계 함수를 적용하는 절입니다.

#### 3.2.1 집계 함수
- COUNT(): 행의 개수 집계
- SUM(): 합계 계산
- AVG(): 평균 계산
- MAX(), MIN(): 최대값, 최소값 계산

#### 3.2.2 예시
```sql
-- 학과별 학생 수 집계
SELECT 학과, COUNT(*) AS 학생수
FROM 학생
GROUP BY 학과;

-- 학생수가 30명 이상인 학과만 조회
SELECT 학과, COUNT(*) AS 학생수
FROM 학생
GROUP BY 학과
HAVING COUNT(*) >= 30;
```

### 3.3 ORDER BY 절
조회 결과를 정렬하는 절입니다.

#### 3.3.1 정렬 옵션
- ASC: 오름차순 정렬 (기본값)
- DESC: 내림차순 정렬
- 다중 정렬 가능

#### 3.3.2 예시
```sql
-- 이름 순으로 정렬
SELECT * FROM 학생 ORDER BY 이름 ASC;

-- 학년 높은 순으로 정렬
SELECT * FROM 학생 ORDER BY 학년 DESC;

-- 학과순, 같은 학과 내에서는 학년 높은 순
SELECT * FROM 학생 
ORDER BY 학과 ASC, 학년 DESC;
```

## 4. 조인 (JOIN)

### 4.1 JOIN의 개념
- 두 개 이상의 테이블을 연결하여 데이터를 조회
- 테이블 간의 관계를 이용하여 필요한 데이터 추출
- 공통 컬럼(기본키와 외래키)을 기준으로 결합

### 4.2 JOIN의 종류

#### 4.2.1 INNER JOIN (내부 조인)
- 두 테이블에서 조건이 일치하는 행만 반환
- 가장 많이 사용되는 조인 방식
- 조건을 만족하지 않는 행은 제외

```sql
SELECT 학생.이름, 수강.과목명
FROM 학생
INNER JOIN 수강
ON 학생.학번 = 수강.학번;
```

#### 4.2.2 LEFT OUTER JOIN (왼쪽 외부 조인)
- 왼쪽 테이블의 모든 행과 오른쪽 테이블의 일치하는 행 반환
- 왼쪽 테이블의 데이터는 모두 표시
- 오른쪽 테이블에 일치하는 데이터가 없으면 NULL

```sql
SELECT 학생.이름, 수강.과목명
FROM 학생
LEFT OUTER JOIN 수강
ON 학생.학번 = 수강.학번;
```

#### 4.2.3 RIGHT OUTER JOIN (오른쪽 외부 조인)
- 오른쪽 테이블의 모든 행과 왼쪽 테이블의 일치하는 행 반환
- 오른쪽 테이블의 데이터는 모두 표시
- 왼쪽 테이블에 일치하는 데이터가 없으면 NULL

```sql
SELECT 학생.이름, 수강.과목명
FROM 학생
RIGHT OUTER JOIN 수강
ON 학생.학번 = 수강.학번;
```

## 5. 서브쿼리

### 5.1 서브쿼리의 개념
- SQL 문 안에 포함된 또 다른 SQL 문
- 메인쿼리의 조건으로 사용되는 종속적인 쿼리
- 괄호로 감싸서 사용
- 비교 연산자나 IN, EXISTS 등과 함께 사용

### 5.2 서브쿼리의 유형

#### 5.2.1 단일행 서브쿼리
- 하나의 행만 반환하는 서브쿼리
- 비교 연산자(=, >, <, >=, <=, <>) 사용
- 집계 함수를 사용한 결과와 비교할 때 유용

```sql
-- 평균 학점보다 높은 학생 조회
SELECT 이름, 학점
FROM 학생
WHERE 학점 > (SELECT AVG(학점) FROM 학생);
```

#### 5.2.2 다중행 서브쿼리
- 여러 행을 반환하는 서브쿼리
- IN, ANY, ALL, EXISTS 등의 연산자 사용
- 여러 조건을 동시에 비교할 때 유용

```sql
-- 컴퓨터공학과 학생들의 수강신청 내역 조회
SELECT *
FROM 수강신청
WHERE 학번 IN (
    SELECT 학번 
    FROM 학생 
    WHERE 학과 = '컴퓨터공학'
);
