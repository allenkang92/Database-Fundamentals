# 데이터 제어어(DCL; Data Control Language)의 개념

## 1. 데이터 제어어의 개념

**데이터 제어어(DCL)**는 데이터베이스 관리자가 데이터 보안, 무결성 유지, 병행 제어, 회복 등을 정의하는데 사용하는 언어입니다.
데이터 제어 정의 및 기술에 사용되는 언어
불법적인 사용자로부터 데이터를 보호한다
무결성을 유지하고 데이터 복구 및 병행 제어를 한다

종류
복구, 병행 제어 
COMMIT
ROLLBACK

보안
GRANT
REVOKE

COMMIT
명령어로 수행된 결과를 실제 물리적 디스크로 저장하고, 명령어로 수행을 성공적으로 완료하였음을 선언한다.

ROLLBACK
명령어로 수행에 실패하였음을 알리고, 수행된 결과를 원상 복귀시킨다.


사용자 시스템 권한
CREATE SESSION
CREATE TABLE
CREATE SEQUENCE
CREATE VIEW
CREATE PROCEDURE

GRANT
GRANT 명령어는 관리자(DBA)가 사용자에게 데이터베이스에 대한 권한을 부여하기 위한 명령어
GRANT 권한 내용 ON 테이블_이름 TO 사용자
관리자자 사용자에게 테이블에 대한 권한을 부여한다.

WITH GRANT OPTION
사용자가 관리자로부터 부여받은 권한을 다른 사용자에게 부여할 수 있는 권한 부여권까지 부여하고자 할 때 사용하는 옵션

REVOKE
관리자(DBA)가 사용자에게 부여했던 권한을 취소하기 위해 사용하는 명령어
REVOKE 권한 내용 ON 테이블_이름 FROM 사용자
관리자가 사용자에게 부여했던 테이블에 대한 권한을 취소한다
CASCADE
사용자가 다른 사용자에게 권한을 부여했을 경우 CASCADE 옵션을 이용해 사용자의 권한을 취소하면 사용자가 부여했던 다른 사용자들의 권한도 연쇄적으로 취소된다.


## 2. 데이터 제어어의 유형

데이터 제어어의 유형에는 GRANT, REVOKE가 있습니다.

### 2.1 GRANT

GRANT는 데이터베이스 관리자(DBA)가 사용자에게 데이터베이스에 대한 권한을 부여하는 명령어입니다.

```sql
GRANT 권한 ON 테이블 TO 사용자;
```

### 2.2 REVOKE

REVOKE는 데이터베이스 관리자(DBA)가 사용자에게 부여했던 권한을 회수하기 위한 명령어입니다.

```sql
REVOKE 권한 ON 테이블 FROM 사용자;
```

## 3. 권한의 종류

### 3.1 시스템 권한

- **CREATE USER**: 사용자를 생성할 수 있는 권한
- **DROP USER**: 사용자를 삭제할 수 있는 권한
- **CREATE TABLE**: 테이블을 생성할 수 있는 권한
- **CREATE VIEW**: 뷰를 생성할 수 있는 권한
- **CREATE PROCEDURE**: 프로시저를 생성할 수 있는 권한

### 3.2 객체 권한

| 권한 | 테이블 | 뷰 | 프로시저 |
|------|--------|-----|----------|
| ALTER | O | X | X |
| DELETE | O | O | X |
| EXECUTE | X | X | O |
| INDEX | O | X | X |
| INSERT | O | O | X |
| REFERENCES | O | X | X |
| SELECT | O | O | X |
| UPDATE | O | O | X |

## 4. ROLE

### 4.1 ROLE의 개념

- 사용자에게 허가할 수 있는 권한들의 집합
- 여러 권한을 하나의 ROLE로 묶어서 관리 가능
- 특정 ROLE을 여러 사용자에게 부여 가능

### 4.2 ROLE 관련 명령어

```sql
-- ROLE 생성
CREATE ROLE role_name;

-- ROLE에 권한 부여
GRANT privilege_name TO role_name;

-- 사용자에게 ROLE 부여
GRANT role_name TO user_name;

-- ROLE 삭제
DROP ROLE role_name;
```

## 5. 사용자 관리

### 5.1 사용자 생성 및 삭제

```sql
-- 사용자 생성
CREATE USER user_name
IDENTIFIED BY password;

-- 사용자 삭제
DROP USER user_name;
```

### 5.2 비밀번호 변경

```sql
-- 비밀번호 변경
ALTER USER user_name
IDENTIFIED BY new_password;
```

## 6. 예시

### 6.1 GRANT 예시

관리자가 사용자 앤드류에게 ‘학생’ 테이블에 대해 UPDATE할 수 있는 권한 부여

```sql
GRANT UPDATE ON 학생 TO 앤드류;
```

### 6.2 REVOKE 예시

관리자가 사용자 앤드류에게 ‘학생’ 테이블에 대해 UPDATE 할 수 있는 권한을 회수

```sql
REVOKE UPDATE ON 학생 FROM 앤드류;

View와 System Catalog

뷰

뷰의 개념 

사용자에게 접근이 허용된 자료만을 제한적으로 보여주기 위해 기본 테이블에서 유도되는 가상 테이블

실제 데이터를 저장하거나 변경하지 않으며, 기존의 데이터를 다양한 형태로 가공하여 제공할 수 있다.

뷰의 특징

뷰의 생성 시 CREATE문, 검색 시 SELECT문을 사용

뷰의 정의 변경 시 ALTER문을 사용할 수 없고 DROP문을 이용한다

뷰를 이용한 또 다른 뷰의 생성이 가능하다

하나의 뷰 제거 시 그 뷰를 기초로 정의된 다른 뷰도 함께 삭제된다.

뷰에 대한 조작에서 삽입, 갱신, 삭제 연산은 제약이 따른다.

뷰가 정의된 기본 테이블이 제거되면 뷰도 자동으로 제거된다.

뷰의 장단점

장점

논리적 데이터 독립성 제공, 사용자 데이터 관리 편의성을 제공함

데이터의 보안성 : View를 사용하여 원본 데이터를 노출하지 않고 필요한 정보만 공개

데이터의 일관성 : View를 사용하여 데이터를 일관성 있게 표현하거나, 중복되는 데이터를 통합하여 관리

데이터의 편의성 : 복잡한 SQL 쿼리를 간단하게 표현하고, 자주 사용되는 데이터를 미리 정리하여 편리하게 사용

단점

ALTER VIEW 문으로 뷰의 정의 변경이 불가능함

삽입, 갱신, 삭제 연산에 제약이 있음

시스템 카탈로그

시스템 카탈로그의 개념

시스템 자신이 필요로 하는 여러 가지 객체(기본 테이블, 뷰, 인덱스, 데이터베이스, 패키지, 접근 권한 등)에 관한 정보를 포함하고 있는 시스템 데이터베이스

데이터 사전이라고도 한다.

사용자가 시스템 카탈로그를 직접 갱신할 수는 없으나 SQL문으로 여러 가지 객체에 변화를 주면 시스템이 자동으로 갱신된다.

시스템 카탈로그 자체도 시스템 테이블로 구성되어 있어 SQL 문을 이용하여 내용 검색이 가능하다

시스템 카탈로그에 저장되는 내용을 메타 데이터(데이터에 대한 정보, 즉 데이터베이스에 저장된 자료들의 정보를 담고 있는 데이터)

시스템 카탈로그의 기능

테이블 정보 조회

데이터베이스에 저장된 테이블의 정보를 조회할 수 있다

예

특정 테이블의 이름, 속성 정보, 제약 조건 등을 확인 가능

뷰 정보 조회

데이터베이스에 저장된 뷰의 정보를 조회할 수 있다

예

뷰의 이름, 정의된 쿼리, 참조하는 원본 테이블 등 확인가능

인덱서 정보 조회

데이터베이스에 저장된 인덱스의 정보를 조회할 수 있다.

예

인덱스의 이름, 인덱스된 열의 정보, 인덱스 종류 등 확인 가능

사용자 계정 정보 조회

데이터베이스에 등록된 사용자 계정 정보를 조회할 수 있다.

사용자 계정의 이름, 비밀번호, 권한 등 확인 가능

인덱스

인덱스의 개념

인덱스는 수많은 데이터 중에서 원하는 자료를 빠르고 효율적으로 검색하기 위해서 사용하는 방법

데이터베이스 성능에 많은 영향을 주는 DBMS의 구성 요소로 테이블과 클러스터에 연관되어 독립적인 저장 공간을 보유한다

인덱스는 기본적으로 데이터의 위치(주소)를 관리, 기억하는 인덱스 파일과 실제 데이터를 기억하는 데이터 파일로 구성된다.

데이터를 검색할 때는 먼저 인덱스 파일에서 데이터의 주소를 찾는다. 이어서 데이터 파일에서 인덱스 파일에서 찾은 주소의 데이터를 검색하게 된다.

인덱스 파일은 [키값, 주소]의 두 가지 정보로 구성된다.

키값: 인덱스를 만들때 사용된 속성의 값, 주소: 실제로 자료가 저장된 위치

인덱스의 추가, 삭제 명령어는 각각 CREATE, DROP

인덱스의 기본 목적은 검색 성능을 최적화하는 것으로 볼 수 있다.

B-트리 인덱스는 분기를 목적으로 하는 Branch Block을 가지고 있다

BETWEEN 등 범위 검색에 활용될 수 있다.

인덱스의 장단점

장점

데이터 검색 속도의 향상

시스템 부하 감소

시스템 전체의 성능 향상

단점

추가 DB 공간의 필요

인덱스 생성 시간 소요

잦은 변경 작업(Insert, Update, Delete)으로 인한 성능 저하

클러스터드 인덱스(Clustered Index)

클러스터드 인덱스의 개념

테이블에서 하나의 속성을 기준으로 정렬시킨 후, 테이블을 재구성하여 인덱스를 만드는 방법

테이블의 물리적 순서(실제 순서)와 인덱스 순서가 동일

하나의 테이블에는 하나의 인덱스만 만들 수 있다.

재구성한 테이블을 일정한 크기로 나눠 Page 단위로 구성하고, 각 data page의 첫 번째 키값(대푯값)과 page 번호로 인덱스를 만든다

page data

페이지 단위로 나누어진 데이터가 저장, 관리되는 곳

page 대푯값은 각 data page의 첫번째 키값으로 인덱스에서 하나의 대표값은 다음 대푯값 이전까지의 범위를 나타낸다

클러스터드 인덱스는 실제 데이터의 순서와 인덱스의 순서가 일치하기 때문에 일정한 범위를 가지고 찾는 경우 속도 향상에 도움이 된다. 삽입, 수정의 경우 변경된 내용을 인덱스에 반영하고 재정렬해야 하므로 넌 클러스터드 인덱스보다 불리하다

넌 클러스터드 인덱스(Non Clustered Index)

넌 클러스터드 인덱스의 개념

넌 클러스터드 인덱스는 테이블을 재구성하지 않고, 데이터 주소로 인덱스를 만들어 주소값을 이용하여 검색하는 방법

넌 클러스터드 인덱스는 하나의 테이블에 여러 개의 인덱스를 만들 수 있다.

한 개의 특정 값을 찾거나, 많은 양의 데이터 중에서 작은 범위를 찾을 때 유용

인덱스 구조보다 다소 복잡해질 수 있다.

키값과 데이터의 위치를 나타내는 ROW id로 구성된 인덱스 페이지를 만든다

ROW id는 (page 그룹, data page 번호, 행 위치)로 구성된다.

인덱스 대푯값과 인덱스 page 번호로 구성된 ROOT 인덱스를 만든다.